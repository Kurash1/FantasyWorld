new named_effect population_tick = {
	#
	# Birth Rate
	#
	
	#	Base: Pops * POPULATION_MONTHLY_BIRTH_RATE
	&base_birth_rate := pops
	&base_birth_rate *= POPULATION_MONTHLY_BIRTH_RATE
	
	#	Modifier: 1 + Birth Modifier + Local Birth Modifier
	&birth_modifier := 0
	&birth_modifier &= modifier:local_birth_rate
	&birth_modifier += owner
	&birth_modifier += 1
	
	#	Size Restriction: Province Size / Pops
	&birth_size_restriction &= trigger_value:province_size
	if [&pops > birth_size_restriction] {
		&birth_size_restriction /= pops
	}
	else {
		&birth_size_restriction := 1
	}
	
	#	Final: Base * Modifier * Size Restriction
	&birth_rate := base_birth_rate
	&birth_rate *= birth_modifier
	&birth_rate *= birth_size_restriction
	
	#
	# Death Rate
	#
	
	#	Base: Pops * POPULATION_MONTHLY_DEATH_RATE
	&base_death_rate := pops
	&base_death_rate *= POPULATION_MONTHLY_DEATH_RATE
	#	Modifier: 1 + Death Modifier + Local Death Modifier
	&death_modifier := 0
	&death_modifier &= modifier:local_death_reduction
	&death_modifier += owner
	&death_modifier += 1
	#	Final: Base / Modifier
	&death_rate := base_death_rate
	&death_rate /= death_modifier
	
	#
	# Growth Rate
	#
	
	#	Base: Birth Rate - Death Rate
	&growth_rate := birth_rate
	&growth_rate -= death_rate
	
	&pops += growth_rate
	
	# Adjust Development
	adjust_development
	
	# Tooltip Generation
	&population := pops
	&population *= 1000
	
	&birth_rate *= 1000
	&base_birth_rate *= 1000
	&death_rate *= 1000
	&base_death_rate *= 1000
	&growth_rate *= 1000
	
	&birth_modifier *= 100
	&birth_size_restriction *= 100
	&death_modifier *= 100
}

on_initialize += {
	every_country = {
		&birth_modifier := 0
		&birth_modifier &= modifier:global_birth_rate
		&death_modifier := 0
		&death_modifier &= modifier:global_death_reduction
		
		every_owned_province = {
			population_tick
		}
	}
}
new named_effect adjust_development = {
	&temp &= development
	&temp *= POP_MULT
	while [&pops >= temp] {
		set_province_flag = cd
		`add_base_production = 1`
		
		&temp &= development
		&temp += 1
		&temp *= POP_MULT
	}
	
	&temp &= development
	&temp *= POP_MULT
	while [&pops < temp] {
		set_province_flag = cd
		`add_base_production = -1`
		
		&temp &= development
		&temp -= 2
		&temp *= POP_MULT
	}
}
on_actions:on_monthly_pulse += {
	&birth_modifier := 0
	&birth_modifier &= modifier:global_birth_rate
	&death_modifier := 0
	&death_modifier &= modifier:global_death_reduction
	
	every_owned_province = {
		population_tick
	}
}